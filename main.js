!function(){"use strict";const e={inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__save-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},t=document.querySelector(".profile"),s=(document.querySelector(".profile__title"),document.querySelector(".profile__subtitle"),document.querySelector(".modal__input_type_name")),r=document.querySelector(".modal__input_type_about"),n=(document.querySelector(".modal__input_type_avatar"),document.querySelector(".profile__edit-button")),i=document.querySelector(".profile__add-button"),o=(document.querySelector(".modal__close-button"),document.querySelector(".profile__avatar-edit")),a=(document.querySelector("#card-template"),document.querySelector("#add-card-form"));var l=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputElements=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleInputError(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this.inputElements)?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._toggleButtonState(this._inputElements,this._submitButton,e),this._inputElements.forEach((t=>{t.addEventListener("input",(s=>{this._toggleInputError(t),this._toggleButtonState(this._inputElements,this._submitButton,e)}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(this._form,e)}resetValidation(){this._toggleButtonState()}};class d{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._container.prepend(e)}addNewItem(e){this._container.append(e)}}class u{constructor(e){var t,s,r;t=this,r=e=>{"Escape"===e.key&&this.closeModal()},(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(s="_handleCloseOnEscape"))in t?Object.defineProperty(t,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[s]=r,this._popupElement=document.querySelector(e),this._closeButtonElement=this._popupElement.querySelector(".modal__close-button")}openModal(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleCloseOnEscape)}closeModal(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleCloseOnEscape)}_handleCloseOnClick(e){e.target===this._popupElement&&this.closeModal()}setEventListeners(){this._closeButtonElement.addEventListener("click",(()=>this.closeModal())),this._popupElement.addEventListener("mousedown",(e=>this._handleCloseOnClick(e)))}}class c extends u{constructor(e,t){super(e),this._handleFormSubmit=t,this._modalForm=this._popupElement.querySelector(".modal__form"),this._inputList=Array.from(this._modalForm.querySelectorAll(".modal__input")),this._saveButton=this._modalForm.querySelector(".modal__save-button")}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}closeModal(){this._modalForm.reset(),super.closeModal()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._saveButton.textContent=e?t:"Save"}setEventListeners(){super.setEventListeners(),this._modalForm.addEventListener("submit",(e=>{e.preventDefault,this.renderLoading(!0);const t=this._getInputValues();this._handleFormSubmit(t)}))}}const h=new class{constructor(e){let{baseUrl:t,headers:s}=e;this.url=t,this.headers=s}_handleServerResponse(e){return e.ok?e.json():Promise.reject(`Error ${e.status}`)}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserData()])}getUserData(){return fetch(`${this.url}/users/me`,{headers:this.headers}).then(this._handleServerResponse)}getInitialCards(){return fetch(`${this.url}/cards`,{headers:this.headers}).then(this._handleServerResponse)}addNewCard(e){let{title:t,link:s}=e;return fetch(`${this.url}/cards`,{headers:this.headers,method:"POST",body:JSON.stringify({name:t,link:s})}).then(this._handleServerResponse)}deleteCard(e){return fetch(`${this.url}/cards/${e}`,{headers:this.headers,method:"DELETE"}).then(this._handleServerResponse)}toggleLikeStatus(e,t){return fetch(`${this.url}/cards/likes/${e}`,{headers:this.headers,method:t?"PUT":"DELETE"}).then(this._handleServerResponse)}submitUserEdit(e){return fetch(`${this.url}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._handleServerResponse)}setAvatar(e){let{avatar:t}=e;return fetch(`${this.url}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:t})}).then(this._handleServerResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"fa002eaa-cfdc-49b2-ba7a-7640eb468742","Content-Type":"application/json"}});let _=null,m=null;const p=new class{constructor(e,t,s){this._userNameElement=document.querySelector(e),this._userAboutElement=document.querySelector(t),this._userAvatarElement=document.querySelector(s)}getUserInfo(){return{name:this._userNameElement.textContent,about:this._userAboutElement.textContent,avatar:this._userAvatarElement.src}}setUserInfo(e){let{userName:t,userAbout:s}=e;this._userNameElement.textContent=t,this._userAboutElement.textContent=s}setAvatar(e){this._userAvatarElement.src=e}}(".profile__title",".profile__subtitle",".profile__image"),v=(e,s)=>{const r=new class{constructor(e,t){let{data:s,userId:r,handleImageClick:n,handleLikeClick:i,handleDeleteClick:o}=e;var a,l,d;a=this,d=()=>this._id,(l=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var r=s.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(l="getCardId"))in a?Object.defineProperty(a,l,{value:d,enumerable:!0,configurable:!0,writable:!0}):a[l]=d,this._data=s,this._title=s.name,this._link=s.link,this._id=s._id,this._userId=r,this._ownerId=s.owner._id,this._likes=s.likes,this._cardSelector=t,this._handleImageClick=n,this._handleLikeClick=i,this._handleDeleteClick=o}_getTemplate(){return document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0)}getView(){this._element=this._getTemplate();const e=this._element.querySelector(".card__image"),t=this._element.querySelector(".card__caption");return this._cardLikeButton=this._element.querySelector(".card__like-button"),this._cardDeleteButton=this._element.querySelector(".card__delete-icon"),this._cardImageButton=this._element.querySelector(".card__image"),this._cardLikesCounter=this._element.querySelector(".card__like-counter"),this._setEventListeners(),e.src=this._link,e.alt=this._title,t.textContent=this._title,this._renderLikes(),this._userId!==this._ownerId&&this._cardDeleteButton.remove(),this._element}handleDeleteCard(){this._element.remove(),this._element.null}setLikes(e){this._likes=e,this._renderLikes()}isLiked(){return this._likes.some((e=>e._id===this._userId))}_renderLikes(){this._cardLikesCounter.textContent=this._likes.length||"",this.isLiked()?this._cardLikeButton.classList.add("card__like-button_active"):this._cardLikeButton.classList.remove("card__like-button_active")}_setEventListeners(){this._cardLikeButton.addEventListener("click",(()=>this._handleLikeClick())),this._cardDeleteButton.addEventListener("click",(()=>this._handleDeleteClick())),this._cardImageButton.addEventListener("click",(()=>this._handleImageClick({title:this._title,link:this._link})))}}({data:e,userId:s,handleImageClick:e=>{f.openModal(e)},handleDeleteClick:()=>{const e=r.getCardId();g.openModal(),g.setSubmitAction((()=>{g.renderLoading(!0),h.deleteCard(e).then((()=>{r.handleDeleteCard(),g.closeModal()})).catch((e=>console.log(e))).finally((()=>{g.renderLoading(!1)}))}))},handleLikeClick:()=>{h.toggleLikeStatus(r.getCardId(),!r.isLiked()).then((e=>r.setLikes(e.likes))).catch((e=>console.log(e)))}},".card-template",t.id);return r.getView()};h.getAppInfo().then((e=>{let[t,s]=e;p.setUserInfo({userName:s.name,userAbout:s.about});const r=s.avatar;p.setAvatar(r),_=s._id,m=new d({items:t,renderer:e=>{const t=v(e,_);m.addNewItem(t)}},".cards__list"),m.renderItems()}));const E=new c("#add-card-modal",(e=>{E.renderLoading(!0),h.addNewCard(e).then((e=>{const t=v(e,e.owner_id);console.log(e),m.addItem(t),a.reset(),E.closeModal()})).finally((()=>{E.renderLoading(!1)}))})),b=new c("#avatar-modal",(e=>{b.renderLoading(!0),h.setAvatar(e).then((e=>{p.setAvatar(e.avatar),b.closeModal()})).catch((e=>console.log(e))).finally((()=>b.renderLoading(!1)))})),S=new c("#edit-profile-modal",(e=>{const t={name:e.name,about:e.about,avatar:e.avatar};h.submitUserEdit(t).then((e=>{p.setUserInfo({userName:e.name,userAbout:e.about}),S.closeModal()})).catch((e=>console.log(e))).finally((()=>{S.renderLoading(!1)}))})),g=new class extends u{constructor(e){super(e),this._form=this._popupElement.querySelector(".modal__form"),this._saveButton=this._form.querySelector(".modal__save-button")}setSubmitAction(e){this._handleSubmitCallback=e}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._saveButton.textContent=e?t:"Save"}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmitCallback()}))}}("#delete-modal");g.setEventListeners();const f=new class extends u{constructor(e){super(e),this._cardImage=this._popupElement.querySelector(".modal__image"),this._cardCaption=this._popupElement.querySelector(".modal__caption")}openModal(e){let{title:t,link:s}=e;this._cardImage.src=s,this._cardImage.alt=t,this._cardCaption.textContent=t,super.openModal()}}("#image-modal");S.setEventListeners(),E.setEventListeners(),f.setEventListeners(),g.setEventListeners(),b.setEventListeners(),n.addEventListener("click",(()=>{!function(){const{name:e,about:t}=p.getUserInfo();s.value=e,r.value=t}(),S.openModal()})),i.addEventListener("click",(()=>{E.openModal(),y.resetValidation()})),o.addEventListener("click",(()=>{b.openModal(),k.resetValidation()}));const y=new l(e,document.querySelector("#add-card-form")),L=new l(e,document.querySelector("#edit-profile-form")),k=new l(e,document.querySelector("#avatar-form"));L.enableValidation(),y.enableValidation(),k.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WnFJLEVBQWdCekosaUJBQWlCLElBR25DLE1BQU13SixFQUFtQixJQUFJRSxFQUMzQi9NLEVBQ0FPLFNBQVNDLGNBQWMsbUJBRW5Cd00sRUFBb0IsSUFBSUQsRUFDNUIvTSxFQUNBTyxTQUFTQyxjQUFjLHVCQUVuQnNNLEVBQWtCLElBQUlDLEVBQzFCL00sRUFDQU8sU0FBU0MsY0FBYyxpQkFHekJ3TSxFQUFrQjdKLG1CQUNsQjBKLEVBQWlCMUosbUJBQ2pCMkosRUFBZ0IzSixrQiIsInNvdXJjZXMiOlsid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9zZV9wcm9qZWN0X2Fyb3VuZHRoZXVzLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtU3VibWl0LmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlLWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XHJcbiAgY2FyZFNlY3Rpb246IFwiLmNhcmRzX19saXN0XCIsXHJcbiAgY2FyZFRlbXBsYXRlOiBcIi5jYXJkLXRlbXBsYXRlXCIsXHJcbiAgcHJldmlld1BvcHVwOiBcIiNpbWFnZS1tb2RhbFwiLFxyXG4gIGVkaXRQcm9maWxlTW9kYWw6IFwiI2VkaXQtcHJvZmlsZS1tb2RhbFwiLFxyXG4gIGVkaXRQcm9maWxlRm9ybTogXCIjZWRpdC1wcm9maWxlLWZvcm1cIixcclxuICBhZGRDYXJkTW9kYWw6IFwiI2FkZC1jYXJkLW1vZGFsXCIsXHJcbiAgdXNlck5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICB1c2VyQWJvdXRTZWxlY3RvcjogXCIucHJvZmlsZV9fc3VidGl0bGVcIixcclxuICB1c2VyQXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXHJcbiAgdXNlckF2YXRhck1vZGFsOiBcIiNhdmF0YXItbW9kYWxcIixcclxuICBpbWFnZU1vZGFsOiBcIiNpbWFnZS1tb2RhbFwiLFxyXG4gIGRlbGV0ZU1vZGFsOiBcIiNkZWxldGUtbW9kYWxcIixcclxuICBhdmF0YXJGb3JtOiBcIiNhdmF0YXItZm9ybVwiLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWVJbnB1dFZhbHVlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9faW5wdXRfdHlwZV9uYW1lXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVBYm91dElucHV0VmFsdWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLm1vZGFsX19pbnB1dF90eXBlX2Fib3V0XCJcclxuKTtcclxuXHJcbmV4cG9ydCBjb25zdCBhdmF0YXJJbnB1dFZhbHVlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9faW5wdXRfdHlwZV9hdmF0YXJcIlxyXG4pO1xyXG5cclxuZXhwb3J0IGNvbnN0IGVkaXRQcm9maWxlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5leHBvcnQgY29uc3QgY2xvc2VNb2RhbEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IGF2YXRhckljb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci1lZGl0XCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpO1xyXG4iLCJpbXBvcnQgeyBjb25maWcgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5jbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dEVsZW1lbnRzLmV2ZXJ5KFxyXG4gICAgICAoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuaW5wdXRFbGVtZW50cykpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dEVsZW1lbnRzLCB0aGlzLl9zdWJtaXRCdXR0b24sIGNvbmZpZyk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKFxyXG4gICAgICAgICAgdGhpcy5faW5wdXRFbGVtZW50cyxcclxuICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbixcclxuICAgICAgICAgIGNvbmZpZ1xyXG4gICAgICAgICk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycyh0aGlzLl9mb3JtLCBjb25maWcpO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyKTtcclxuICB9XHJcblxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b25FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLm1vZGFsX19jbG9zZS1idXR0b25cIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIG9wZW5Nb2RhbCgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlQ2xvc2VPbkVzY2FwZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZU1vZGFsKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVDbG9zZU9uRXNjYXBlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVDbG9zZU9uRXNjYXBlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZU1vZGFsKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZUNsb3NlT25DbGljayhldnQpIHtcclxuICAgIGlmIChldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cEVsZW1lbnQpIHtcclxuICAgICAgdGhpcy5jbG9zZU1vZGFsKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZU1vZGFsKCkpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlQ2xvc2VPbkNsaWNrKGV2dClcclxuICAgICk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fbW9kYWxGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9tb2RhbEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIilcclxuICAgICk7XHJcbiAgICB0aGlzLl9zYXZlQnV0dG9uID0gdGhpcy5fbW9kYWxGb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgZm9ybURhdGEgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBmb3JtRGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gZm9ybURhdGE7XHJcbiAgfVxyXG5cclxuICBjbG9zZU1vZGFsKCkge1xyXG4gICAgdGhpcy5fbW9kYWxGb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZU1vZGFsKCk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmVcIjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX21vZGFsRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0O1xyXG4gICAgICB0aGlzLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcblxyXG4gICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtU3VibWl0IGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm1TdWJtaXQuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcblxyXG5pbXBvcnQge1xyXG4gIGNvbmZpZyxcclxuICBzZWxlY3RvcnMsXHJcbiAgcHJvZmlsZSxcclxuICBwcm9maWxlTmFtZUlucHV0VmFsdWUsXHJcbiAgcHJvZmlsZUFib3V0SW5wdXRWYWx1ZSxcclxuICBhZGRDYXJkQnV0dG9uLFxyXG4gIGVkaXRQcm9maWxlQnV0dG9uLFxyXG4gIGFkZENhcmRGb3JtLFxyXG4gIGF2YXRhckljb24sXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJmYTAwMmVhYS1jZmRjLTQ5YjItYmE3YS03NjQwZWI0Njg3NDJcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxubGV0IHVzZXJJZCA9IG51bGw7XHJcbmxldCBjYXJkU2VjdGlvbiA9IG51bGw7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyhcclxuICBzZWxlY3RvcnMudXNlck5hbWVTZWxlY3RvcixcclxuICBzZWxlY3RvcnMudXNlckFib3V0U2VsZWN0b3IsXHJcbiAgc2VsZWN0b3JzLnVzZXJBdmF0YXJTZWxlY3RvclxyXG4pO1xyXG5cclxuY29uc3QgY3JlYXRlQ2FyZCA9IChkYXRhLCB1c2VySWQpID0+IHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICB7XHJcbiAgICAgIGRhdGE6IGRhdGEsXHJcbiAgICAgIHVzZXJJZDogdXNlcklkLFxyXG4gICAgICBoYW5kbGVJbWFnZUNsaWNrOiAoaW1nRGF0YSkgPT4ge1xyXG4gICAgICAgIGNhcmRQcmV2aWV3UG9wdXAub3Blbk1vZGFsKGltZ0RhdGEpO1xyXG4gICAgICB9LFxyXG4gICAgICBoYW5kbGVEZWxldGVDbGljazogKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGlkID0gY2FyZC5nZXRDYXJkSWQoKTtcclxuICAgICAgICBkZWxldGVQb3B1cC5vcGVuTW9kYWwoKTtcclxuICAgICAgICBkZWxldGVQb3B1cC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgICAgICAgZGVsZXRlUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAuZGVsZXRlQ2FyZChpZClcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGNhcmQuaGFuZGxlRGVsZXRlQ2FyZCgpO1xyXG4gICAgICAgICAgICAgIGRlbGV0ZVBvcHVwLmNsb3NlTW9kYWwoKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXHJcbiAgICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgICAgICBkZWxldGVQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGhhbmRsZUxpa2VDbGljazogKCkgPT4ge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLnRvZ2dsZUxpa2VTdGF0dXMoY2FyZC5nZXRDYXJkSWQoKSwgIWNhcmQuaXNMaWtlZCgpKVxyXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4gY2FyZC5zZXRMaWtlcyhyZXMubGlrZXMpKVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICAgIHNlbGVjdG9ycy5jYXJkVGVtcGxhdGUsXHJcbiAgICBwcm9maWxlLmlkXHJcbiAgKTtcclxuICByZXR1cm4gY2FyZC5nZXRWaWV3KCk7XHJcbn07XHJcblxyXG5mdW5jdGlvbiBmaWxsUHJvZmlsZUZvcm0oKSB7XHJcbiAgY29uc3QgeyBuYW1lLCBhYm91dCB9ID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBwcm9maWxlTmFtZUlucHV0VmFsdWUudmFsdWUgPSBuYW1lO1xyXG4gIHByb2ZpbGVBYm91dElucHV0VmFsdWUudmFsdWUgPSBhYm91dDtcclxufVxyXG5cclxuYXBpLmdldEFwcEluZm8oKS50aGVuKChbY2FyZHNBcnJheSwgdXNlckRhdGFdKSA9PiB7XHJcbiAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgdXNlck5hbWU6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICB1c2VyQWJvdXQ6IHVzZXJEYXRhLmFib3V0LFxyXG4gIH0pO1xyXG5cclxuICBjb25zdCB1c2VyQXZhdGFyID0gdXNlckRhdGEuYXZhdGFyO1xyXG4gIHVzZXJJbmZvLnNldEF2YXRhcih1c2VyQXZhdGFyKTtcclxuXHJcbiAgdXNlcklkID0gdXNlckRhdGEuX2lkO1xyXG4gIGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICB7XHJcbiAgICAgIGl0ZW1zOiBjYXJkc0FycmF5LFxyXG4gICAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcclxuICAgICAgICBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChkYXRhLCB1c2VySWQpO1xyXG4gICAgICAgIGNhcmRTZWN0aW9uLmFkZE5ld0l0ZW0oY2FyZCk7XHJcbiAgICAgIH0sXHJcbiAgICB9LFxyXG4gICAgc2VsZWN0b3JzLmNhcmRTZWN0aW9uXHJcbiAgKTtcclxuICBjYXJkU2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG59KTtcclxuXHJcbmNvbnN0IGFkZENhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHNlbGVjdG9ycy5hZGRDYXJkTW9kYWwsIChkYXRhKSA9PiB7XHJcbiAgYWRkQ2FyZFBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgZGVidWdnZXI7XHJcbiAgYXBpXHJcbiAgICAuYWRkTmV3Q2FyZChkYXRhKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZCA9IGNyZWF0ZUNhcmQoZGF0YSwgZGF0YS5vd25lcl9pZCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xyXG4gICAgICBhZGRDYXJkRm9ybS5yZXNldCgpO1xyXG4gICAgICBhZGRDYXJkUG9wdXAuY2xvc2VNb2RhbCgpO1xyXG4gICAgfSlcclxuXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbmNvbnN0IGF2YXRhck1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oc2VsZWN0b3JzLnVzZXJBdmF0YXJNb2RhbCwgKGF2YXRhcikgPT4ge1xyXG4gIGF2YXRhck1vZGFsLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuc2V0QXZhdGFyKGF2YXRhcilcclxuICAgIC50aGVuKCh1c2VyKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldEF2YXRhcih1c2VyLmF2YXRhcik7XHJcbiAgICAgIGF2YXRhck1vZGFsLmNsb3NlTW9kYWwoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IGF2YXRhck1vZGFsLnJlbmRlckxvYWRpbmcoZmFsc2UpKTtcclxufSk7XHJcblxyXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgc2VsZWN0b3JzLmVkaXRQcm9maWxlTW9kYWwsXHJcbiAgKGRhdGEpID0+IHtcclxuICAgIGNvbnN0IHVwZGF0ZVVzZXIgPSB7XHJcbiAgICAgIG5hbWU6IGRhdGEubmFtZSxcclxuICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXHJcbiAgICAgIGF2YXRhcjogZGF0YS5hdmF0YXIsXHJcbiAgICB9O1xyXG4gICAgYXBpXHJcbiAgICAgIC5zdWJtaXRVc2VyRWRpdCh1cGRhdGVVc2VyKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oeyB1c2VyTmFtZTogcmVzLm5hbWUsIHVzZXJBYm91dDogcmVzLmFib3V0IH0pO1xyXG4gICAgICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2VNb2RhbCgpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICAgIGVkaXRQcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuKTtcclxuXHJcbmNvbnN0IGRlbGV0ZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm1TdWJtaXQoc2VsZWN0b3JzLmRlbGV0ZU1vZGFsKTtcclxuZGVsZXRlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmNvbnN0IGNhcmRQcmV2aWV3UG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoc2VsZWN0b3JzLmltYWdlTW9kYWwpO1xyXG5cclxuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5hZGRDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuY2FyZFByZXZpZXdQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5kZWxldGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5hdmF0YXJNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBmaWxsUHJvZmlsZUZvcm0oKTtcclxuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW5Nb2RhbCgpO1xyXG59KTtcclxuXHJcbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXAub3Blbk1vZGFsKCk7XHJcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcblxyXG5hdmF0YXJJY29uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYXZhdGFyTW9kYWwub3Blbk1vZGFsKCk7XHJcbiAgYXZhdGFyVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBjb25maWcsXHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpXHJcbik7XHJcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uZmlnLFxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1wcm9maWxlLWZvcm1cIilcclxuKTtcclxuY29uc3QgYXZhdGFyVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uZmlnLFxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWZvcm1cIilcclxuKTtcclxuXHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmF2YXRhclZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIHRoaXMudXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuaGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlU2VydmVyUmVzcG9uc2UocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvciAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBnZXRBcHBJbmZvKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJEYXRhKCldKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJEYXRhKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMudXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGFkZE5ld0NhcmQoeyB0aXRsZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbmFtZTogdGl0bGUsIGxpbmsgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2hhbmRsZVNlcnZlclJlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLnVybH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICB0b2dnbGVMaWtlU3RhdHVzKGlkLCBpc0xpa2VkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiUFVUXCIgOiBcIkRFTEVURVwiLFxyXG4gICAgfSkudGhlbih0aGlzLl9oYW5kbGVTZXJ2ZXJSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBzdWJtaXRVc2VyRWRpdChkYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy51cmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0OiBkYXRhLmFib3V0LFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgc2V0QXZhdGFyKHsgYXZhdGFyIH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLnVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlU2VydmVyUmVzcG9uc2UpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3IodXNlck5hbWVTZWxlY3RvciwgdXNlckFib3V0U2VsZWN0b3IsIHVzZXJBdmF0YXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fdXNlck5hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyTmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3VzZXJBYm91dEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJBYm91dFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3VzZXJBdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyQXZhdGFyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl91c2VyTmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgIGFib3V0OiB0aGlzLl91c2VyQWJvdXRFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBhdmF0YXI6IHRoaXMuX3VzZXJBdmF0YXJFbGVtZW50LnNyYyxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IHVzZXJOYW1lLCB1c2VyQWJvdXQgfSkge1xyXG4gICAgdGhpcy5fdXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gdXNlck5hbWU7XHJcbiAgICB0aGlzLl91c2VyQWJvdXRFbGVtZW50LnRleHRDb250ZW50ID0gdXNlckFib3V0O1xyXG4gIH1cclxuXHJcbiAgc2V0QXZhdGFyKHVzZXJBdmF0YXIpIHtcclxuICAgIHRoaXMuX3VzZXJBdmF0YXJFbGVtZW50LnNyYyA9IHVzZXJBdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgeyBkYXRhLCB1c2VySWQsIGhhbmRsZUltYWdlQ2xpY2ssIGhhbmRsZUxpa2VDbGljaywgaGFuZGxlRGVsZXRlQ2xpY2sgfSxcclxuICAgIGNhcmRTZWxlY3RvclxyXG4gICkge1xyXG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XHJcbiAgICB0aGlzLl90aXRsZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgdGhpcy5fb3duZXJJZCA9IGRhdGEub3duZXIuX2lkO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q2FyZElkID0gKCkgPT4gdGhpcy5faWQ7XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIHJldHVybiBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG5cclxuICAgIGNvbnN0IGltYWdlRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIGNvbnN0IGNhcHRpb25FbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2NhcHRpb25cIik7XHJcbiAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2NhcmREZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWljb25cIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkTGlrZXNDb3VudGVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtY291bnRlclwiKTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIGltYWdlRWxlbWVudC5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgaW1hZ2VFbGVtZW50LmFsdCA9IHRoaXMuX3RpdGxlO1xyXG4gICAgY2FwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSB0aGlzLl90aXRsZTtcclxuXHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG5cclxuICAgIGlmICh0aGlzLl91c2VySWQgIT09IHRoaXMuX293bmVySWQpIHtcclxuICAgICAgdGhpcy5fY2FyZERlbGV0ZUJ1dHRvbi5yZW1vdmUoKTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcblxyXG4gIGhhbmRsZURlbGV0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudC5udWxsO1xyXG4gIH1cclxuXHJcbiAgc2V0TGlrZXMobGlrZXMpIHtcclxuICAgIHRoaXMuX2xpa2VzID0gbGlrZXM7XHJcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gdGhpcy5fdXNlcklkKTtcclxuICB9XHJcblxyXG4gIF9yZW5kZXJMaWtlcygpIHtcclxuICAgIHRoaXMuX2NhcmRMaWtlc0NvdW50ZXIudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGggfHwgXCJcIjtcclxuICAgIGlmICh0aGlzLmlzTGlrZWQoKSkge1xyXG4gICAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fY2FyZExpa2VCdXR0b24uY2xhc3NMaXN0LnJlbW92ZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2soKVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljaygpXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX2NhcmRJbWFnZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7IHRpdGxlOiB0aGlzLl90aXRsZSwgbGluazogdGhpcy5fbGluayB9KVxyXG4gICAgKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IENhcmQ7XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybVN1Ym1pdCBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX3NhdmVCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3NhdmUtYnV0dG9uXCIpO1xyXG4gIH1cclxuICBzZXRTdWJtaXRBY3Rpb24oYWN0aW9uKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXRDYWxsYmFjayA9IGFjdGlvbjtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlU3VibWl0Q2FsbGJhY2soKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZENhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuICB9XHJcblxyXG4gIG9wZW5Nb2RhbCh7IHRpdGxlLCBsaW5rIH0pIHtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRpdGxlO1xyXG4gICAgdGhpcy5fY2FyZENhcHRpb24udGV4dENvbnRlbnQgPSB0aXRsZTtcclxuXHJcbiAgICBzdXBlci5vcGVuTW9kYWwoKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbImNvbmZpZyIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwicHJvZmlsZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInByb2ZpbGVOYW1lSW5wdXRWYWx1ZSIsInByb2ZpbGVBYm91dElucHV0VmFsdWUiLCJlZGl0UHJvZmlsZUJ1dHRvbiIsImFkZENhcmRCdXR0b24iLCJhdmF0YXJJY29uIiwiYWRkQ2FyZEZvcm0iLCJjb25zdHJ1Y3RvciIsImZvcm1FbGVtZW50IiwidGhpcyIsIl9pbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJfZm9ybSIsIl9pbnB1dEVsZW1lbnRzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJpZCIsImNsYXNzTGlzdCIsImFkZCIsInRleHRDb250ZW50IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfdG9nZ2xlSW5wdXRFcnJvciIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGFzSW52YWxpZElucHV0IiwiZXZlcnkiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJpbnB1dEVsZW1lbnRzIiwiZGlzYWJsZWQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJmb3JFYWNoIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2dCIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJhZGROZXdJdGVtIiwiYXBwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwia2V5IiwiY2xvc2VNb2RhbCIsIl9wb3B1cEVsZW1lbnQiLCJfY2xvc2VCdXR0b25FbGVtZW50Iiwib3Blbk1vZGFsIiwiX2hhbmRsZUNsb3NlT25Fc2NhcGUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiX2hhbmRsZUNsb3NlT25DbGljayIsInRhcmdldCIsInNldEV2ZW50TGlzdGVuZXJzIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX21vZGFsRm9ybSIsIl9pbnB1dExpc3QiLCJfc2F2ZUJ1dHRvbiIsIl9nZXRJbnB1dFZhbHVlcyIsImZvcm1EYXRhIiwiaW5wdXQiLCJuYW1lIiwidmFsdWUiLCJyZXNldCIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJsb2FkaW5nVGV4dCIsImlucHV0VmFsdWVzIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJ1cmwiLCJfaGFuZGxlU2VydmVyUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0QXBwSW5mbyIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImdldFVzZXJEYXRhIiwiZmV0Y2giLCJ0aGVuIiwiYWRkTmV3Q2FyZCIsInRpdGxlIiwibGluayIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZGVsZXRlQ2FyZCIsInRvZ2dsZUxpa2VTdGF0dXMiLCJpc0xpa2VkIiwic3VibWl0VXNlckVkaXQiLCJkYXRhIiwiYWJvdXQiLCJzZXRBdmF0YXIiLCJhdmF0YXIiLCJhdXRob3JpemF0aW9uIiwidXNlcklkIiwiY2FyZFNlY3Rpb24iLCJ1c2VySW5mbyIsInVzZXJOYW1lU2VsZWN0b3IiLCJ1c2VyQWJvdXRTZWxlY3RvciIsInVzZXJBdmF0YXJTZWxlY3RvciIsIl91c2VyTmFtZUVsZW1lbnQiLCJfdXNlckFib3V0RWxlbWVudCIsIl91c2VyQXZhdGFyRWxlbWVudCIsImdldFVzZXJJbmZvIiwic3JjIiwic2V0VXNlckluZm8iLCJ1c2VyTmFtZSIsInVzZXJBYm91dCIsInVzZXJBdmF0YXIiLCJjcmVhdGVDYXJkIiwiY2FyZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsIl9pZCIsIl9kYXRhIiwiX3RpdGxlIiwiX2xpbmsiLCJfdXNlcklkIiwiX293bmVySWQiLCJvd25lciIsIl9saWtlcyIsImxpa2VzIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9nZXRUZW1wbGF0ZSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJnZXRWaWV3IiwiX2VsZW1lbnQiLCJpbWFnZUVsZW1lbnQiLCJjYXB0aW9uRWxlbWVudCIsIl9jYXJkTGlrZUJ1dHRvbiIsIl9jYXJkRGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZUJ1dHRvbiIsIl9jYXJkTGlrZXNDb3VudGVyIiwiYWx0IiwiX3JlbmRlckxpa2VzIiwiaGFuZGxlRGVsZXRlQ2FyZCIsIm51bGwiLCJzZXRMaWtlcyIsInNvbWUiLCJsaWtlIiwibGVuZ3RoIiwiaW1nRGF0YSIsImNhcmRQcmV2aWV3UG9wdXAiLCJnZXRDYXJkSWQiLCJkZWxldGVQb3B1cCIsInNldFN1Ym1pdEFjdGlvbiIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImZpbmFsbHkiLCJjYXJkc0FycmF5IiwidXNlckRhdGEiLCJhZGRDYXJkUG9wdXAiLCJvd25lcl9pZCIsImF2YXRhck1vZGFsIiwidXNlciIsImVkaXRQcm9maWxlUG9wdXAiLCJ1cGRhdGVVc2VyIiwiYWN0aW9uIiwiX2hhbmRsZVN1Ym1pdENhbGxiYWNrIiwiX2NhcmRJbWFnZSIsIl9jYXJkQ2FwdGlvbiIsImZpbGxQcm9maWxlRm9ybSIsImFkZEZvcm1WYWxpZGF0b3IiLCJhdmF0YXJWYWxpZGF0b3IiLCJGb3JtVmFsaWRhdG9yIiwiZWRpdEZvcm1WYWxpZGF0b3IiXSwic291cmNlUm9vdCI6IiJ9