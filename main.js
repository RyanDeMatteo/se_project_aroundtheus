!function(){"use strict";const e={inputSelector:".modal__input",submitButtonSelector:".modal__save-button",inactiveButtonClass:"modal__save-button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},t=(document.querySelector(".profile__title"),document.querySelector(".profile__subtitle"),document.querySelector(".modal__input_type_name")),s=document.querySelector(".modal__input_type_about"),n=document.querySelector(".profile__edit-button"),i=document.querySelector(".profile__add-button");document.querySelector(".modal__close-button"),document.querySelector("#card-template"),document.querySelector("#add-card-form");var o=class{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._form=t,this._inputElements=Array.from(this._form.querySelectorAll(this._inputSelector)),this._submitButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_toggleInputError(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return!this._inputElements.every((e=>e.validity.valid))}_toggleButtonState(){this._hasInvalidInput(this.inputElements)?(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0):(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_setEventListeners(){this._toggleButtonState(this._inputElements,this._submitButton,e),this._inputElements.forEach((t=>{t.addEventListener("input",(s=>{this._toggleInputError(t),this._toggleButtonState(this._inputElements,this._submitButton,e)}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners(this._form,e)}resetValidation(){this._toggleButtonState()}};function r(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class l{constructor(e){var t,s,n;t=this,n=e=>{"Escape"===e.key&&this.closeModal()},(s=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var n=s.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}(s="_handleCloseOnEscape"))in t?Object.defineProperty(t,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[s]=n,this._popupElement=document.querySelector(e),this._closeButtonElement=this._popupElement.querySelector(".modal__close-button")}openModal(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleCloseOnEscape)}closeModal(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleCloseOnEscape)}_handleCloseOnClick(e){e.target===this._popupElement&&this.closeModal()}setEventListeners(){this._closeButtonElement.addEventListener("click",(()=>this.closeModal())),this._popupElement.addEventListener("mousedown",(e=>this._handleCloseOnClick(e)))}}class a extends l{constructor(e,t){super(e),this._handleFormSubmit=t,this._modalForm=this._popupElement.querySelector(".modal__form"),this._inputList=Array.from(this._modalForm.querySelectorAll(".modal__input"))}_getInputValues(){const e={};return this._inputList.forEach((t=>{e[t.name]=t.value})),e}closeModal(){console.log(this._modalForm),this._modalForm.reset(),super.closeModal()}setEventListeners(){super.setEventListeners(),this._modalForm.addEventListener("submit",(e=>{e.preventDefault;const t=this._getInputValues();this._handleFormSubmit(t)}))}}function u(e){const t=d(e);_.addItem(t)}document.getElementById("profile-image").src="bbe7c5b6093ec0273de1.jpg";const c=new class{constructor(e,t){this._userNameElement=document.querySelector(e),this._userAboutElement=document.querySelector(t)}getUserInfo(){return{name:this._userNameElement.textContent,about:this._userAboutElement.textContent}}setUserInfo(e){let{userName:t,userAbout:s}=e;this._userNameElement.textContent=t,this._userAboutElement.textContent=s}}(".profile__title",".profile__subtitle"),d=e=>new class{constructor(e,t){let{data:s,handleImageClick:n}=e;r(this,"_handleLikeIcon",(()=>{this._cardLikeButton.classList.toggle("card__like-button_active")})),r(this,"_handleDeleteCard",(()=>{this._element.remove(),this._element=null})),this._data=s,this._title=s.title,this._link=s.link,this._handleImageClick=n,this._cardSelector=t}_getTemplate(){return document.querySelector("#card-template").content.querySelector(".card").cloneNode(!0)}getView(){this._element=this._getTemplate();const e=this._element.querySelector(".card__image"),t=this._element.querySelector(".card__caption");return this._cardLikeButton=this._element.querySelector(".card__like-button"),this._cardDeleteButton=this._element.querySelector(".card__delete-icon"),this._cardImageButton=this._element.querySelector(".card__image"),e.src=this._link,e.alt=this._title,t.textContent=this._title,this._setEventListeners(),this._element}_setEventListeners(){this._cardLikeButton.addEventListener("click",this._handleLikeIcon),this._cardDeleteButton.addEventListener("click",this._handleDeleteCard),this._cardImageButton.addEventListener("click",(()=>this._handleImageClick(this._data)))}}({data:e,handleImageClick:e=>{m.openModal(e)}},".card-template").getView(),_=new class{constructor(e,t){let{items:s,renderer:n}=e;this._items=s,this._renderer=n,this._container=document.querySelector(t)}renderItems(){this._items.forEach(this._renderer)}addItem(e){this._container.prepend(e)}addNewItem(e){this._container.append(e)}}({items:[{title:"Lago di Braies",link:"https://code.s3.yandex.net/web-code/lago.jpg"},{title:"Vanoise National Park",link:"https://code.s3.yandex.net/web-code/vanoise.jpg"},{title:"Latemar",link:"https://code.s3.yandex.net/web-code/latemar.jpg"},{title:"Bald Mountains",link:"https://code.s3.yandex.net/web-code/bald-mountains.jpg"},{title:"Lake Louise",link:"https://code.s3.yandex.net/web-code/lake-louise.jpg"},{title:"Yosemite Valley",link:"https://code.s3.yandex.net/web-code/yosemite.jpg"}],renderer:e=>{u(e)}},"#cards-list");_.renderItems();const m=new class extends l{constructor(e){super(e),this._cardImage=this._popupElement.querySelector(".modal__image"),this._cardCaption=this._popupElement.querySelector(".modal__caption")}openModal(e){let{title:t,link:s}=e;this._cardImage.src=s,this._cardImage.alt=t,this._cardCaption.textContent=t,super.openModal()}}("#image-modal"),h=new a("#add-card-modal",(e=>{u({title:e.title,link:e.link}),h.closeModal()})),p=new a("#edit-profile-modal",(e=>{c.setUserInfo({userName:e.name,userAbout:e.about}),p.closeModal()}));m.setEventListeners(),h.setEventListeners(),i.addEventListener("click",(()=>{h.openModal(),v.resetValidation()})),p.setEventListeners(),n.addEventListener("click",(()=>{!function(){const{name:e,about:n}=c.getUserInfo();t.value=e,s.value=n}(),p.openModal()}));const v=new o(e,document.querySelector("#add-card-form"));new o(e,document.querySelector("#edit-profile-form")).enableValidation(),v.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QyxjQUFjLG1CQUdDLElBQUltSSxFQUM1QjNJLEVBQ0FPLFNBQVNDLGNBQWMsdUJBR1B3QyxtQkFFbEJ5RixFQUFpQnpGLGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9hcm91bmR0aGV1cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3NlX3Byb2plY3RfYXJvdW5kdGhldXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgY29uZmlnID0ge1xyXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fc2F2ZS1idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlLWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgdGl0bGU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFnby5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIHRpdGxlOiBcIlZhbm9pc2UgTmF0aW9uYWwgUGFya1wiLFxyXG4gICAgbGluazogXCJodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAgeyB0aXRsZTogXCJMYXRlbWFyXCIsIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGdcIiB9LFxyXG4gIHtcclxuICAgIHRpdGxlOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgdGl0bGU6IFwiTGFrZSBMb3Vpc2VcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICB0aXRsZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XHJcbiAgY2FyZFNlY3Rpb246IFwiY2FyZHNfX2xpc3RcIixcclxuICBjYXJkVGVtcGxhdGU6IFwiLmNhcmQtdGVtcGxhdGVcIixcclxuICBwcmV2aWV3UG9wdXA6IFwiI2ltYWdlLW1vZGFsXCIsXHJcbiAgZWRpdFByb2ZpbGVNb2RhbDogXCIjZWRpdC1wcm9maWxlLW1vZGFsXCIsXHJcbiAgZWRpdFByb2ZpbGVGb3JtOiBcIiNlZGl0LXByb2ZpbGUtZm9ybVwiLFxyXG4gIGFkZENhcmRNb2RhbDogXCIjYWRkLWNhcmQtbW9kYWxcIixcclxuICB1c2VyTmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIHVzZXJBYm91dFNlbGVjdG9yOiBcIi5wcm9maWxlX19zdWJ0aXRsZVwiLFxyXG4gIGltYWdlTW9kYWw6IFwiI2ltYWdlLW1vZGFsXCIsXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZU5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUFib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19zdWJ0aXRsZVwiKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lSW5wdXRWYWx1ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIubW9kYWxfX2lucHV0X3R5cGVfbmFtZVwiXHJcbik7XHJcbmV4cG9ydCBjb25zdCBwcm9maWxlQWJvdXRJbnB1dFZhbHVlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIi5tb2RhbF9faW5wdXRfdHlwZV9hYm91dFwiXHJcbik7XHJcblxyXG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBjbG9zZU1vZGFsQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCIpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKTtcclxuZXhwb3J0IGNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpO1xyXG4iLCJpbXBvcnQgeyBjb25maWcgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcblxyXG5jbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihjb25maWcsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gY29uZmlnLmlucHV0U2VsZWN0b3I7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IGNvbmZpZy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBjb25maWcuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IGNvbmZpZy5pbnB1dEVycm9yQ2xhc3M7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gY29uZmlnLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF90b2dnbGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dEVsZW1lbnRzLmV2ZXJ5KFxyXG4gICAgICAoaW5wdXRFbGVtZW50KSA9PiBpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuaW5wdXRFbGVtZW50cykpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSh0aGlzLl9pbnB1dEVsZW1lbnRzLCB0aGlzLl9zdWJtaXRCdXR0b24sIGNvbmZpZyk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKFxyXG4gICAgICAgICAgdGhpcy5faW5wdXRFbGVtZW50cyxcclxuICAgICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbixcclxuICAgICAgICAgIGNvbmZpZ1xyXG4gICAgICAgICk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycyh0aGlzLl9mb3JtLCBjb25maWcpO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IEZvcm1WYWxpZGF0b3I7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b25FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiLm1vZGFsX19jbG9zZS1idXR0b25cIlxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIG9wZW5Nb2RhbCgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlQ2xvc2VPbkVzY2FwZSk7XHJcbiAgfVxyXG5cclxuICBjbG9zZU1vZGFsKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVDbG9zZU9uRXNjYXBlKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVDbG9zZU9uRXNjYXBlID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZU1vZGFsKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZUNsb3NlT25DbGljayhldnQpIHtcclxuICAgIGlmIChldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cEVsZW1lbnQpIHtcclxuICAgICAgdGhpcy5jbG9zZU1vZGFsKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4gdGhpcy5jbG9zZU1vZGFsKCkpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT5cclxuICAgICAgdGhpcy5faGFuZGxlQ2xvc2VPbkNsaWNrKGV2dClcclxuICAgICk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fbW9kYWxGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9tb2RhbEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIilcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICBjb25zdCBmb3JtRGF0YSA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGZvcm1EYXRhW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBmb3JtRGF0YTtcclxuICB9XHJcblxyXG4gIGNsb3NlTW9kYWwoKSB7XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLl9tb2RhbEZvcm0pO1xyXG4gICAgdGhpcy5fbW9kYWxGb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZU1vZGFsKCk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9tb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdDtcclxuXHJcbiAgICAgIGNvbnN0IGlucHV0VmFsdWVzID0gdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdChpbnB1dFZhbHVlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcblxyXG5pbXBvcnQgcHJvZmlsZURlZmF1bHQgZnJvbSBcIi4uL2ltYWdlcy9qYWNxdWVzLWNvdXN0ZWF1LmpwZ1wiO1xyXG5cclxuaW1wb3J0IHtcclxuICBjb25maWcsXHJcbiAgc2VsZWN0b3JzLFxyXG4gIGluaXRpYWxDYXJkcyxcclxuICBwcm9maWxlTmFtZUlucHV0VmFsdWUsXHJcbiAgcHJvZmlsZUFib3V0SW5wdXRWYWx1ZSxcclxuICBhZGRDYXJkQnV0dG9uLFxyXG4gIGVkaXRQcm9maWxlQnV0dG9uLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuXHJcbmNvbnN0IHByb2ZpbGVQaWN0dXJlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlLWltYWdlXCIpO1xyXG5wcm9maWxlUGljdHVyZS5zcmMgPSBwcm9maWxlRGVmYXVsdDtcclxuXHJcbmZ1bmN0aW9uIGZpbGxQcm9maWxlRm9ybSgpIHtcclxuICBjb25zdCB7IG5hbWUsIGFib3V0IH0gPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIHByb2ZpbGVOYW1lSW5wdXRWYWx1ZS52YWx1ZSA9IG5hbWU7XHJcbiAgcHJvZmlsZUFib3V0SW5wdXRWYWx1ZS52YWx1ZSA9IGFib3V0O1xyXG59XHJcblxyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGRhdGEpIHtcclxuICBjb25zdCBjYXJkRGF0YSA9IGNyZWF0ZUNhcmQoZGF0YSk7XHJcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShjYXJkRGF0YSk7XHJcbn1cclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKFxyXG4gIHNlbGVjdG9ycy51c2VyTmFtZVNlbGVjdG9yLFxyXG4gIHNlbGVjdG9ycy51c2VyQWJvdXRTZWxlY3RvclxyXG4pO1xyXG5cclxuY29uc3QgY3JlYXRlQ2FyZCA9IChjYXJkT2JqZWN0KSA9PiB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAge1xyXG4gICAgICBkYXRhOiBjYXJkT2JqZWN0LFxyXG4gICAgICBoYW5kbGVJbWFnZUNsaWNrOiAoaW1nRGF0YSkgPT4ge1xyXG4gICAgICAgIGNhcmRQcmV2aWV3UG9wdXAub3Blbk1vZGFsKGltZ0RhdGEpO1xyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICAgIHNlbGVjdG9ycy5jYXJkVGVtcGxhdGVcclxuICApO1xyXG4gIHJldHVybiBjYXJkLmdldFZpZXcoKTtcclxufTtcclxuXHJcbmNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAge1xyXG4gICAgaXRlbXM6IGluaXRpYWxDYXJkcyxcclxuICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xyXG4gICAgICByZW5kZXJDYXJkKGRhdGEpO1xyXG4gICAgfSxcclxuICB9LFxyXG4gIFwiI2NhcmRzLWxpc3RcIlxyXG4pO1xyXG5cclxuY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuXHJcbmNvbnN0IGNhcmRQcmV2aWV3UG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoc2VsZWN0b3JzLmltYWdlTW9kYWwpO1xyXG5cclxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oc2VsZWN0b3JzLmFkZENhcmRNb2RhbCwgKGRhdGEpID0+IHtcclxuICBjb25zdCBuZXdDYXJkID0geyB0aXRsZTogZGF0YS50aXRsZSwgbGluazogZGF0YS5saW5rIH07XHJcbiAgcmVuZGVyQ2FyZChuZXdDYXJkKTtcclxuICBhZGRDYXJkUG9wdXAuY2xvc2VNb2RhbCgpO1xyXG59KTtcclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBzZWxlY3RvcnMuZWRpdFByb2ZpbGVNb2RhbCxcclxuICAoZGF0YSkgPT4ge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgICB1c2VyTmFtZTogZGF0YS5uYW1lLFxyXG4gICAgICB1c2VyQWJvdXQ6IGRhdGEuYWJvdXQsXHJcbiAgICB9KTtcclxuICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2VNb2RhbCgpO1xyXG4gIH1cclxuKTtcclxuXHJcbmNhcmRQcmV2aWV3UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZENhcmRQb3B1cC5vcGVuTW9kYWwoKTtcclxuICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgZmlsbFByb2ZpbGVGb3JtKCk7XHJcbiAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuTW9kYWwoKTtcclxufSk7XHJcblxyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uZmlnLFxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZm9ybVwiKVxyXG4pO1xyXG5cclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBjb25maWcsXHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtZm9ybVwiKVxyXG4pO1xyXG5cclxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih1c2VyTmFtZVNlbGVjdG9yLCB1c2VyQWJvdXRTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fdXNlck5hbWVFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih1c2VyTmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3VzZXJBYm91dEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHVzZXJBYm91dFNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fdXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICBhYm91dDogdGhpcy5fdXNlckFib3V0RWxlbWVudC50ZXh0Q29udGVudCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IHVzZXJOYW1lLCB1c2VyQWJvdXQgfSkge1xyXG4gICAgdGhpcy5fdXNlck5hbWVFbGVtZW50LnRleHRDb250ZW50ID0gdXNlck5hbWU7XHJcbiAgICB0aGlzLl91c2VyQWJvdXRFbGVtZW50LnRleHRDb250ZW50ID0gdXNlckFib3V0O1xyXG4gIH1cclxufVxyXG4iLCJjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIGhhbmRsZUltYWdlQ2xpY2sgfSwgY2FyZFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIHRoaXMuX3RpdGxlID0gZGF0YS50aXRsZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIHJldHVybiBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG5cclxuICAgIGNvbnN0IGltYWdlRWxlbWVudCA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcclxuICAgIGNvbnN0IGNhcHRpb25FbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2NhcHRpb25cIik7XHJcbiAgICB0aGlzLl9jYXJkTGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2NhcmREZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWljb25cIik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcblxyXG4gICAgaW1hZ2VFbGVtZW50LnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICBpbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5fdGl0bGU7XHJcbiAgICBjYXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IHRoaXMuX3RpdGxlO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlSWNvbiA9ICgpID0+IHtcclxuICAgIHRoaXMuX2NhcmRMaWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZURlbGV0ZUNhcmQgPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgfTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2FyZExpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUxpa2VJY29uKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkRGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fZGF0YSlcclxuICAgICk7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBDYXJkO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3SXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fY2FyZENhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcclxuICB9XHJcblxyXG4gIG9wZW5Nb2RhbCh7IHRpdGxlLCBsaW5rIH0pIHtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRpdGxlO1xyXG4gICAgdGhpcy5fY2FyZENhcHRpb24udGV4dENvbnRlbnQgPSB0aXRsZTtcclxuXHJcbiAgICBzdXBlci5vcGVuTW9kYWwoKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbImNvbmZpZyIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwicHJvZmlsZU5hbWVJbnB1dFZhbHVlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwicHJvZmlsZUFib3V0SW5wdXRWYWx1ZSIsImVkaXRQcm9maWxlQnV0dG9uIiwiYWRkQ2FyZEJ1dHRvbiIsImNvbnN0cnVjdG9yIiwiZm9ybUVsZW1lbnQiLCJ0aGlzIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9mb3JtIiwiX2lucHV0RWxlbWVudHMiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yRWxlbWVudCIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsInJlbW92ZSIsIl90b2dnbGVJbnB1dEVycm9yIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJldmVyeSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0RWxlbWVudHMiLCJkaXNhYmxlZCIsIl9zZXRFdmVudExpc3RlbmVycyIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZXZ0IiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwia2V5IiwiY2xvc2VNb2RhbCIsIl9wb3B1cEVsZW1lbnQiLCJfY2xvc2VCdXR0b25FbGVtZW50Iiwib3Blbk1vZGFsIiwiX2hhbmRsZUNsb3NlT25Fc2NhcGUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiX2hhbmRsZUNsb3NlT25DbGljayIsInRhcmdldCIsInNldEV2ZW50TGlzdGVuZXJzIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX21vZGFsRm9ybSIsIl9pbnB1dExpc3QiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJmb3JtRGF0YSIsImlucHV0IiwibmFtZSIsInZhbHVlIiwiY29uc29sZSIsImxvZyIsInJlc2V0IiwiaW5wdXRWYWx1ZXMiLCJyZW5kZXJDYXJkIiwiZGF0YSIsImNhcmREYXRhIiwiY3JlYXRlQ2FyZCIsImNhcmRTZWN0aW9uIiwiYWRkSXRlbSIsImdldEVsZW1lbnRCeUlkIiwic3JjIiwidXNlckluZm8iLCJ1c2VyTmFtZVNlbGVjdG9yIiwidXNlckFib3V0U2VsZWN0b3IiLCJfdXNlck5hbWVFbGVtZW50IiwiX3VzZXJBYm91dEVsZW1lbnQiLCJnZXRVc2VySW5mbyIsImFib3V0Iiwic2V0VXNlckluZm8iLCJ1c2VyTmFtZSIsInVzZXJBYm91dCIsImNhcmRPYmplY3QiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiX2NhcmRMaWtlQnV0dG9uIiwidG9nZ2xlIiwiX2VsZW1lbnQiLCJfZGF0YSIsIl90aXRsZSIsInRpdGxlIiwiX2xpbmsiLCJsaW5rIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfY2FyZFNlbGVjdG9yIiwiX2dldFRlbXBsYXRlIiwiY29udGVudCIsImNsb25lTm9kZSIsImdldFZpZXciLCJpbWFnZUVsZW1lbnQiLCJjYXB0aW9uRWxlbWVudCIsIl9jYXJkRGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZUJ1dHRvbiIsImFsdCIsIl9oYW5kbGVMaWtlSWNvbiIsIl9oYW5kbGVEZWxldGVDYXJkIiwiaW1nRGF0YSIsImNhcmRQcmV2aWV3UG9wdXAiLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJlbGVtZW50IiwicHJlcGVuZCIsImFkZE5ld0l0ZW0iLCJhcHBlbmQiLCJfY2FyZEltYWdlIiwiX2NhcmRDYXB0aW9uIiwiYWRkQ2FyZFBvcHVwIiwiZWRpdFByb2ZpbGVQb3B1cCIsImFkZEZvcm1WYWxpZGF0b3IiLCJmaWxsUHJvZmlsZUZvcm0iLCJGb3JtVmFsaWRhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==